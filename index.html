function doGet() {
  try {
    const ss = SpreadsheetApp.getActiveSpreadsheet();
    const sheet = ss.getSheets()[0]; // 一番左のシートを読み込む
    const rows = sheet.getDataRange().getValues();
    
    // 1行目（見出し）を削除
    rows.shift();
    
    // データを整形
    const data = rows.map(function(row) {
      return { q: row[0], a: row[1] };
    }).filter(function(item) {
      return item.q; // 問題が入っていない空行は除外
    });
    
    // JSON形式で返却
    return ContentService.createTextOutput(JSON.stringify(data))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (e) {
    // エラーが発生した場合はエラーメッセージを返す
    return ContentService.createTextOutput(JSON.stringify({error: e.toString()}))
      .setMimeType(ContentService.MimeType.JSON);
  }
}
