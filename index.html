<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>漢字プリント・テーブル版</title>
    <style>
        :root {
            --ink-black: #000000;
            --main-font: "UD Digital Kyokasho N-R", "UD デジタル 教科書体 N-R", sans-serif;
        }

        body { margin: 0; padding: 20px; background-color: #e0d8c3; font-family: var(--main-font); }

        #list-view-screen {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #fff; z-index: 200; overflow-x: auto; padding: 40px;
            writing-mode: vertical-rl; /* 全体を縦書きに */
        }

        .print-container { display: flex; height: 90vh; }

        /* 15問1セットのテーブル */
        .kanji-table {
            border-collapse: collapse;
            border: 2px solid var(--ink-black);
            background: white;
            margin-left: 50px; /* ページ間の余白 */
            height: 100%;
        }

        .kanji-table td {
            border: 1px solid var(--ink-black);
            width: 65px; /* 列の幅 */
            text-align: center;
            vertical-align: middle;
            padding: 5px;
        }

        /* 1段目：チェックボックス */
        .row-check { height: 60px; font-size: 24px; color: #27ae60; }
        .square { width: 30px; height: 30px; border: 2px solid #000; margin: auto; display: flex; align-items: center; justify-content: center; }

        /* 2段目・4段目：番号 */
        .row-num { height: 40px; font-size: 16px; font-weight: bold; background: #f0f0f0; }

        /* 3段目：問題（メイン） */
        .row-question { 
            height: auto; /* 残りの高さを埋める */
            font-size: 20px; 
            line-height: 1.8; 
            text-align: start; 
            vertical-align: top;
            padding: 20px 5px;
        }

        /* 5段目：答え */
        .row-answer { height: 150px; font-size: 18px; font-weight: bold; color: #e74c3c; }

        /* タイトル（表の横に配置） */
        .sheet-title-vertical {
            font-size: 28px; font-weight: bold; border-left: 4px double #000;
            padding: 20px; margin-left: 10px; height: 100%; display: flex; align-items: center;
        }

        #close-btn {
            position: fixed; top: 20px; right: 20px; writing-mode: horizontal-tb;
            padding: 10px 25px; background: #ff4757; color: white; border-radius: 30px; border: none; font-weight: bold; cursor: pointer;
        }
    </style>
</head>
<body>

<div id="list-view-screen">
    <button id="close-btn" onclick="document.getElementById('list-view-screen').style.display='none'">× とじる</button>
    <div id="print-area" class="print-container"></div>
</div>

<div id="menu">
    <button onclick="showPrintView('サンプルシート')">問題一覧を表示（テスト）</button>
</div>

<script>
    // 仮のデータ構造（実際はAPIから取得）
    const sampleQuestions = Array.from({length: 35}, (_, i) => ({
        q: `これは第${i+1}問目の（かんじ）の練習です。`,
        a: `漢字${i+1}`
    }));

    function showPrintView(sheetName) {
        const questions = sampleQuestions; // 実際は allData[sheetName]
        const area = document.getElementById('print-area');
        area.innerHTML = "";

        // 15問ずつテーブルを作成
        for (let i = 0; i < questions.length; i += 15) {
            const chunk = questions.slice(i, i + 15);
            
            // シート名
            const title = document.createElement('div');
            title.className = "sheet-title-vertical";
            title.innerText = sheetName;
            area.appendChild(title);

            // テーブル作成
            const table = document.createElement('table');
            table.className = "kanji-table";

            // 5行の構成を作成
            const rows = {
                check: document.createElement('tr'),
                numTop: document.createElement('tr'),
                q: document.createElement('tr'),
                numBottom: document.createElement('tr'),
                a: document.createElement('tr')
            };
            
            rows.check.className = "row-check";
            rows.numTop.className = "row-num";
            rows.q.className = "row-question";
            rows.numBottom.className = "row-num";
            rows.a.className = "row-answer";

            // 各問題のデータを列(td)として追加
            chunk.forEach((q, idx) => {
                const qIdx = i + idx + 1;
                
                // 1. チェック
                rows.check.innerHTML += `<td><div class="square"></div></td>`;
                // 2. 番号（上）
                rows.numTop.innerHTML += `<td>${qIdx}</td>`;
                // 3. 問題
                rows.q.innerHTML += `<td>${q.q.replace(/[（\(].*?[）\)]/g, '（　　）')}</td>`;
                // 4. 番号（下）
                rows.numBottom.innerHTML += `<td>${qIdx}</td>`;
                // 5. 答え
                rows.a.innerHTML += `<td>${q.a}</td>`;
            });

            Object.values(rows).forEach(row => table.appendChild(row));
            area.appendChild(table);
        }

        document.getElementById('list-view-screen').style.display = "block";
    }
</script>
</body>
</html>
