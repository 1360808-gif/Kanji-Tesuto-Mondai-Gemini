<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¼¢å­—å­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ </title>
    <style>
        :root {
            --ink-black: #000000;
            --main-font: "UD Digital Kyokasho N-R", "UD ãƒ‡ã‚¸ã‚¿ãƒ« æ•™ç§‘æ›¸ä½“ N-R", sans-serif;
        }

        body { margin: 0; font-family: var(--main-font); background: #e0d8c3; }

        /* --- ãƒ¢ãƒ¼ãƒ‰é¸æŠç”»é¢ --- */
        #menu-screen {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 100vh; gap: 20px;
        }
        .select-box { padding: 10px; font-size: 1.2rem; border-radius: 8px; width: 300px; }
        .mode-buttons { display: flex; gap: 20px; }
        .btn-large { 
            padding: 20px 40px; font-size: 1.5rem; font-weight: bold; cursor: pointer;
            border: none; border-radius: 12px; transition: 0.2s;
        }
        .btn-view { background: #3498db; color: white; }
        .btn-print { background: #2ecc71; color: white; }
        .btn-large:hover { opacity: 0.8; transform: translateY(-2px); }

        /* --- å…±é€šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ --- */
        .screen-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #f0f0f0; z-index: 100; }
        .view-header {
            width: 100%; height: 50px; display: flex; justify-content: space-between; align-items: center;
            padding: 0 20px; box-sizing: border-box; background: #fff; border-bottom: 1px solid #ccc;
        }
        #view-mode-container { height: calc(100vh - 50px); display: flex; align-items: center; justify-content: center; padding: 10px; box-sizing: border-box; }

        /* å°åˆ·æ™‚è¨­å®š */
        @media print {
            body { background: white !important; overflow: visible !important; }
            .screen-overlay { position: static !important; display: block !important; background: white !important; }
            .view-header { display: none !important; }
            #view-mode-container { height: auto !important; display: block !important; padding: 0 !important; }
            .view-canvas { 
                width: 285mm !important; height: 185mm !important; 
                margin: 0 auto !important; 
                border: 2px solid #000 !important; box-shadow: none !important; 
                page-break-after: always !important; 
                padding: 10mm !important;
            }
            .view-canvas:last-child { page-break-after: auto !important; }
            .ans-text { color: black !important; }
        }

        /* --- ã‚­ãƒ£ãƒ³ãƒã‚¹ãƒ»ã‚°ãƒªãƒƒãƒ‰ --- */
        .view-canvas {
            display: flex; flex-direction: row-reverse; height: 96%; width: 96vw; max-width: 1600px;
            background: white; border: 2px solid #000; box-sizing: border-box; padding: 20px; overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .kanji-table-grid {
            display: flex; flex-direction: row-reverse; height: 100%; flex-grow: 1; border: 1px solid #000; 
            background: #000; gap: 1px;
        }
        .column-unit { border-collapse: collapse; height: 100%; flex-grow: 1; table-layout: fixed; background: white; }
        .column-unit td { border: 1px solid #000; text-align: center; vertical-align: middle; padding: 0; }
        
        /* --- å®Œç’§ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆè¨­å®šï¼ˆå¾©å…ƒï¼‰ --- */
        .h-check { height: 10%; } 
        .h-num { height: 6%; font-size: 1.4vh; }
        
        /* ã€ä¿®æ­£ã€‘å•é¡Œæ–‡ã‚¨ãƒªã‚¢ï¼šå‰å›æˆåŠŸã—ãŸè¨­å®šã‚’å®Œå…¨ã«å¾©å…ƒ */
        .h-ques { 
            height: 53%; 
            writing-mode: vertical-rl; 
            text-orientation: upright; 
            text-align: start; /* è¡Œå†…ã®æ–‡å­—ã‚’ä¸Šï¼ˆå³ï¼‰ç«¯ã«æƒãˆã‚‹ */
            padding: 12px 2px; 
            font-size: min(1.9vh, 17px); 
            line-height: 1.3;
        }
        /* ã€ä¿®æ­£ã€‘ãƒ©ãƒƒãƒ‘ãƒ¼ï¼šFlexboxã§ä¸Šï¼ˆå³ï¼‰ç«¯ã‹ã‚‰é…ç½®ã‚’é–‹å§‹ã™ã‚‹ */
        .ques-wrapper {
            display: flex;
            justify-content: flex-start; /* ã“ã‚Œã§å‚ç›´æ–¹å‘ã®ä¸Šç«¯ã«æƒã† */
            height: 100%;
            width: 100%;
        }

        .h-num2 { height: 6%; font-size: 1.4vh; }
        .h-ans { height: 25%; position: relative; }
        
        .ans-wrapper { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            display: flex; align-items: center; justify-content: center; 
            writing-mode: vertical-rl; text-orientation: upright; 
        }
        .ans-text { font-size: 2.3vh; font-weight: bold; color: #e74c3c; line-height: 1; }
        
        .print-title { writing-mode: vertical-rl; font-weight: bold; border: 1px solid #000; border-left: 4px double #000; padding: 0 15px; font-size: 1.3rem; margin-left: 15px; background: white; }
        .square { width: 20px; height: 20px; border: 1px solid #000; margin: auto; }
        .btn-action { padding: 6px 16px; border-radius: 20px; border: 1px solid #333; cursor: pointer; font-weight: bold; background: white; }
    </style>
</head>
<body>

<div id="menu-screen">
    <h1 style="color:#2c3e50;">æ¼¢å­—å­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ </h1>
    <select id="sheet-select" class="select-box">
        <option value="">-- ã‚·ãƒ¼ãƒˆã‚’é¸æŠã—ã¦ãã ã•ã„ --</option>
        <option value="6å¹´ã‚„ã¾ãªã—">6å¹´ ã‚„ã¾ãªã—</option>
        <option value="6å¹´ã‚«ãƒ¬ãƒ¼ãƒ©ã‚¤ã‚¹">6å¹´ ã‚«ãƒ¬ãƒ¼ãƒ©ã‚¤ã‚¹</option>
    </select>
    <div class="mode-buttons">
        <button class="btn-large btn-view" onclick="startMode('view')">ğŸ‘€ é–²è¦§ç”¨</button>
        <button class="btn-large btn-print" onclick="startMode('print')">ğŸ–¨ï¸ å°åˆ·ç”¨(PDF)</button>
    </div>
</div>

<div id="main-display" class="screen-overlay">
    <div class="view-header">
        <button class="btn-action" onclick="backToMenu()" style="background:#ff4757; color:white; border:none;">Ã— ã‚‚ã©ã‚‹</button>
        <div id="page-info" style="font-weight:bold;"></div>
        <div id="nav-buttons">
            <button id="prevBtn" class="btn-action" onclick="changePage(-1)">â† å‰ã¸</button>
            <button id="nextBtn" class="btn-action" onclick="changePage(1)">æ¬¡ã¸ â†’</button>
        </div>
    </div>
    <div id="view-mode-container">
        </div>
</div>

<script>
    // å‹•ä½œç¢ºèªç”¨ï¼šé•·æ–‡å«ã‚€60å•ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿
    const allQuestions = Array.from({length: 60}, (_, i) => ({
        id: i + 1,
        q: `ç¬¬${i+1}å•ç›®ã®æ¼¢å­—å•é¡Œã€‚ã“ã‚Œã¯éå¸¸ã«é•·ã„æ–‡ç« ã®ãƒ†ã‚¹ãƒˆã§ã™ã€‚ï¼’è¡Œç›®ã‚‚ï¼‘æ–‡å­—ç›®ãŒæƒã†ã‹ç¢ºèªã€‚`,
        a: `æ­£è§£${i+1}`
    }));

    let currentPage = 0;
    const itemsPerPage = 15;
    let currentMode = '';

    function startMode(mode) {
        const sheet = document.getElementById('sheet-select').value;
        if (!sheet) { alert('ã‚·ãƒ¼ãƒˆã‚’é¸æŠã—ã¦ãã ã•ã„'); return; }

        currentMode = mode;
        document.getElementById('menu-screen').style.display = 'none';
        document.getElementById('main-display').style.display = 'block';
        
        if (mode === 'view') {
            document.getElementById('nav-buttons').style.display = 'block';
            currentPage = 0;
            renderViewPage();
        } else {
            document.getElementById('nav-buttons').style.display = 'none';
            renderAllForPrint();
            setTimeout(() => { window.print(); }, 500);
        }
    }

    // é–²è¦§ãƒ¢ãƒ¼ãƒ‰ï¼šç¾åœ¨ã®ãƒšãƒ¼ã‚¸ã ã‘æç”»
    function renderViewPage() {
        const container = document.getElementById('view-mode-container');
        container.innerHTML = '';
        const start = currentPage * itemsPerPage;
        const pageData = allQuestions.slice(start, start + itemsPerPage);
        
        container.appendChild(createCanvasElement(pageData));
        
        document.getElementById('page-info').innerText = `${start + 1} ã€œ ${start + pageData.length} å•ç›®`;
        document.getElementById('prevBtn').disabled = currentPage === 0;
        document.getElementById('nextBtn').disabled = (start + itemsPerPage) >= allQuestions.length;
    }

    // å°åˆ·ãƒ¢ãƒ¼ãƒ‰ï¼šå…¨ãƒšãƒ¼ã‚¸ã‚’ä¸€æ‹¬æç”»
    function renderAllForPrint() {
        const container = document.getElementById('view-mode-container');
        container.innerHTML = '';
        const totalPages = Math.ceil(allQuestions.length / itemsPerPage);
        
        for (let p = 0; p < totalPages; p++) {
            const pageData = allQuestions.slice(p * itemsPerPage, (p + 1) * itemsPerPage);
            container.appendChild(createCanvasElement(pageData));
        }
        document.getElementById('page-info').innerText = `ä¸€æ‹¬å°åˆ·ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆå…¨${totalPages}ãƒšãƒ¼ã‚¸ï¼‰`;
    }

    // Canvasç”Ÿæˆé–¢æ•°
    function createCanvasElement(data) {
        const canvas = document.createElement('div');
        canvas.className = 'view-canvas';
        
        const title = document.createElement('div');
        title.className = 'print-title';
        title.innerText = document.getElementById('sheet-select').value;
        canvas.appendChild(title);

        const grid = document.createElement('div');
        grid.className = 'kanji-table-grid';
        
        data.forEach(item => {
            const table = document.createElement('table');
            table.className = "column-unit";
            table.innerHTML = `
                <tr><td class="h-check"><div class="square"></div></td></tr>
                <tr><td class="h-num">${item.id}</td></tr>
                <td class="h-ques">
                    <div class="ques-wrapper">${item.q}</div>
                </td>
                <tr><td class="h-num2">${item.id}</td></tr>
                <td class="h-ans">
                    <div class="ans-wrapper"><span class="ans-text">${item.a}</span></div>
                </td>
            `;
            grid.appendChild(table);
        });
        
        canvas.appendChild(grid);
        return canvas;
    }

    function changePage(step) { currentPage += step; renderViewPage(); }
    function backToMenu() {
        document.getElementById('menu-screen').style.display = 'flex';
        document.getElementById('main-display').style.display = 'none';
        document.getElementById('view-mode-container').innerHTML = '';
    }
</script>
</body>
</html>
